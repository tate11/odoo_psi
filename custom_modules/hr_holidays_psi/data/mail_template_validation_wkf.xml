<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>

		<record id="custom_template_validation_conge" model="mail.template">
			<field name="name">PSI Congé - Mail demande de congé</field>
			<field name="model_id" ref="hr_holidays_psi.model_hr_holidays" />
			<field name="email_from"><![CDATA[${object.create_uid.email or object.company_id.email}]]></field>
			<field name="email_to">${object.employee_id.work_email or object.user_id.email}</field>
			<field name="email_cc">
					%if object.state in ('draft'):  
	            		${object.employee_id.coach_id.work_mail or object.employee_id.coach_id.user_id.email}
	            	%endif 
					%if object.state in ('confirm'):  
	            		${object.employee_id.department_id.manager_id.work_mail or object.employee_id.department_id.manager_id.user_id.email}
	            	%endif 
	            	%if object.state == ('approbation'):
	            		% for user_psi in object.env['res.users'].sudo().search([]):
							% if user_psi.has_group('hr_holidays_psi.group_hr_holidays_rh'):
								${user_psi.email},
							% endif
						% endfor 
					%endif
	            	%if object.state == ('validate2'):
	            		% for user_psi in object.env['res.users'].sudo().search([]):
							% if user_psi.has_group('hr_holidays_psi.group_hr_holidays_drha'):
								${user_psi.email},
							% endif
						% endfor 
					%endif
					
			</field>
			<field name="subject">Demande de congé</field>
			<field name="body_html"><![CDATA[            	
            	<div style="padding:0px;width:600px;background: #FFFFFF repeat top /100%;color:#777777">
	            	<h3>Demande de congé de ${object.employee_id.name} :</h3>
	            	<ul>
	            		<li>Type de congé :  ${object.holiday_status_id.name}</li>
	            		<li>Date de début :  ${object.date_from}</li>
	            		<li>Date de fin :  ${object.date_to}</li>
	            		<li>Durée :  ${object.number_of_days_temp} jour(s)</li>
					</ul>
	            	%if object.state in ('draft'):  
	            		<p>Etat: A Soumettre pour validation => A valider par le Supérieur hiérarchique</p>  
	            	%endif 
	            	%if object.state in ('confirm'):  
	            		<p>Etat: A valider par le Supérieur hiérarchique => A valider par le Chef de département</p> 
	            	%endif 
	            	%if object.state == ('validate1'):  
	            		<p>Etat: A valider par le Chef de département => A valider par le Responsable RH</p> 
	            	%endif
	            	%if object.state == ('approbation'):  
	            		<p>Etat: A valider par le Responsable RH  => A valider par le DRHA</p> 
	            	%endif
	            	%if object.state == ('validate2') or object.state == ('validate'):  
	            		<p>Etat: Validé par le DRHA</p> 
	            	%endif
	            	
            		<hr/>
            		<p>Supérieur hiérarchique : ${object.employee_id.coach_id.name} </p>
            		<p>Chef de Département : ${object.employee_id.department_id.manager_id.name} </p>
            		
            		<h2>Liste group RH</h2>
	            	
			        % for user_psi in object.env['res.users'].sudo().search([]):
						% if user_psi.has_group('hr_holidays_psi.group_hr_holidays_rh'):
						<ul>
							<li>${user_psi.name}</li>
							<li>${user_psi.email}</li>
						</ul>
						% endif
					% endfor
					
					
            		<h2>Liste group DRHA</h2>
	            	
			        % for user_psi in object.env['res.users'].sudo().search([]):
						% if user_psi.has_group('hr_holidays_psi.group_hr_holidays_drha'):
						<ul>
							<li>${user_psi.name}</li>
							<li>${user_psi.email}</li>
						</ul>
						% endif
					% endfor
					
					
            	</div>
				]]></field>
			<field name="user_signature" eval="True" />
		</record>


		<record id="custom_template_refuse_conge" model="mail.template">
			<field name="name">PSI Congé - Mail refuse congé</field>
			<field name="model_id" ref="hr_holidays_psi.model_hr_holidays" />
			<field name="email_from">${object.create_uid.email or
				object.company_id.email}</field>
			<field name="email_to">${object.employee_id.work_email or
				object.user_id.email}</field>
			<field name="subject">Refus de congé de ${object.employee_id.name}
			</field>
			<field name="body_html"><![CDATA[            	
            	<div style="padding:0px;width:600px;background: #FFFFFF repeat top /100%;color:#777777">
	            	<h3>Votre demande de congé :</h3>
	            	<ul>
	            		<li>Type de congé :  ${object.holiday_status_id.name}</li>
	            		<li>Date de début :  ${object.date_from}</li>
	            		<li>Date de fin :  ${object.date_to}</li>
	            		<li>Durée :  ${object.number_of_days_temp} jour(s)</li>
	            	</ul>
	            	<p>Etat : Demande refusée par 
	            	%if object.state == ('approbation'):  
	            		le Responsable RH </p> 
	            	%endif
	            	%if object.state == ('validate2'):  
	            		le DRHA</p> 
	            	%endif
            	</div>
				]]></field>
			<field name="user_signature" eval="True" />
		</record>

	</data>
</odoo>