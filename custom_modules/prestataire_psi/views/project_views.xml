<?xml version="1.0" encoding="utf-8"?>
<odoo>
	
	<record id="view_task_form_prestataire" model="ir.ui.view">
            <field name="name">project.task.form</field>
            <field name="model">project.task</field>
            <field eval="2" name="priority"/>
            <field name="inherit_id" ref="project.view_task_form2" />
            <field name="arch" type="xml">
              <field name="date_deadline" position="replace">
                    <field name="date_deadline" invisible="1"/>
              </field>
              <field name="name" position="replace">
                    <field name="stage_id" invisible="1"/>
              </field>
              
          	</field>
    </record>
    <!-- Task -->
        <record id="view_task_form_prestataire" model="ir.ui.view">
            <field name="name">project.task.form</field>
            <field name="model">project.task</field>
            <field eval="2" name="priority"/>
            <field name="inherit_id" ref="project.view_task_form2" />
            <field name="arch" type="xml">
            <field name="project_id" position="replace" >
            	<field name="project_id" options="{'no_quick_create': True, 'no_create_edit' : True}" />
            </field>
            <field name="user_id" position="replace">
            	<field name="user_id" class="o_task_user_field" options='{"no_open": True}' readonly="1"/>
            </field>
            
             <xpath expr="//notebook/page[@name='description_page']" position="after">
                    <page string="Timesheets" attrs="{'invisible': [('project_id', '=', False)]}">
                    <field name="timesheet_ids" context="{'default_project_id': project_id}">
                        <tree editable="bottom" string="Timesheet Activities" default_order="date">
                            <field name="date"/>
                            <field name="user_id" required="1" readonly="1"/>
                            <field name="name"/>
                            <field name="hours_prestataire_id" reauired="1"/>
                            <field name="unit_amount" string="Duration" widget="float_time" invisible="1"/>
                            <field name="project_id" invisible="1"/>
                        </tree>
                    </field>
                    <group>
                     <group class="oe_subtotal_footer oe_right" name="project_hours">
                        <field name="effective_hours" widget="float_time"/>
                        <field name="children_hours" widget="float_time" attrs="{'invisible' : [('children_hours', '=', 0.0)]}"/>
                        <field name="total_hours_spent" widget="float_time" class="oe_subtotal_footer_separator" attrs="{'invisible' : [('children_hours', '=', 0.0)]}"/>
                        <field name="remaining_hours" widget="float_time" class="oe_subtotal_footer_separator" readonly="1"/>
                     </group>
                    </group>
                </page>
                </xpath>
                    
                    
            </field>
        </record>
        
            <record id="action_form_timesheet_prestataire" model="ir.actions.act_window">
            <field name="name">Tasks</field>
            <field name="res_model">project.task</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('user_id', '=', uid)]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Here, you can create new tasks
                </p>
                <p>
                    You can now manage your tasks in order to get things done efficiently. Track progress, discuss, attach documents, etc.
                </p>
            </field>
        </record>
        
        <!-- Top menu item -->
        <menuitem name="Prestataire - Feuilles de temps"
            id="menu_main_pm"
            groups="prestataire_psi.group_prestataire,hr_holidays_psi.group_hr_holidays_rh"
            web_icon="prestataire_psi,static/description/icon_timesheet.png"
            sequence="50" action="action_form_timesheet_prestataire"/>
         
         <menuitem action="project.open_view_project_all_config" 
         	id="project.menu_projects_config" name="Projects" groups="group_permanent"
         	parent="project.menu_project_config" sequence="10"/>
         
</odoo>